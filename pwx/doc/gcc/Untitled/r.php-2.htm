<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><title>www.ПЕРВЫЕ ШАГИ.ru :: Шаг 2 - Отладочная информация</title></head><link rel=stylesheet type=text/css href="2.css" tppabs="http://www.firststeps.ru/2.css"><body text=black bgcolor=white link=blue vlink=blue alink=red><h2>Шаг 2 - Отладочная информация</h2><div style="margin:10px;"><p>Любой компилятор по умолчанию снабжает объектный файл отладочной информацией. Компилятор <b>gcc</b> также снабжает файл такой информацией и на результат вы можете посмотреть сами. При компиляции проекта из <a href="r.php-1.htm" tppabs="http://www.firststeps.ru/linux/r.php?1">предыдущего шага</a> у нас появился файл <b>a.out</b> размером <b>11817</b> байт (возможно у вас он может быть другого размера).
<p>Вся эта отладочная информация предназначается для отладки программы отладчиком <b>GNU Debugger</b>. Запустить его вы можете командой:
<pre>
gdb a.out
</pre>
<p>При этом запустится отладчик и наша скомпилированная программа. Об отладке мы с вами поговорим отдельно и более подробно.
<p>Компилятор <b>gcc</b> может создавать отладочную информацию в различных объемах и форматах, контролировать которые можно специальными ключами. Посмотреть их подробное описание можно командой <b>man gcc</b>:
<pre>
Debugging Options
	-a -dletters -fpretend-float -g -glevel -gcoff
	-gxcoff -gxcoff+ -gdwarf -gdwarf+ -gstabs -gstabs+
	-ggdb -p -pg -save-temps -print-file-name=library
	-print-libgcc-file-name -print-prog-name=program
</pre>
<p>Ключ <b>-g</b> создает отладочню информацию в родном для операционной системы виде, он выбирает между несколькими форматами: <b>stabs</b>, <b>COFF</b>, <b>XCOFF</b> или <b>DWARF</b>. На многих системах данный ключ позволяет использовать специальную информацию, которую умеет использовать только отладчик <b>gdb</b>. Другие ключи позволяют более тонко контролировать процесс встраивания отладочной информации.
<p>Ключ <b>-ggdb</b> включает в исполняемый файл отладочную информацию в родном для ОС виде и дополняет ее специализированной информацией для отладчика <b>gdb</b>.
<p>Ключ <b>-gstabs</b> создает отладочную информацию в формате <b>stabs</b> без дополнительных расширений <b>gdb</b>. Данный формат используется отладчиком <b>DBX</b> на большинстве <b>BSD</b> систем. Ключ <b>-gstabs+</b> дополняет отладочную информацию расширенниями понятными отладчику <b>gdb</b>.
<p>Ключ <b>-gcoff</b> создает отладочную информацию в формате <b>COFF</b>, которая используется отладчиком <b>SDB</b> на большинстве систем <b>System V</b> до версии <b>System V R4</b>.
<p>Ключ <b>-gxcoff</b> снабжает файл информацией в формате <b>XCOFF</b>, который используется отладчиком <b>DBX</b> на системах <b>IBM RS/6000</b>. Использование <b>-gxcoff+</b> влкючает использование дополнительной информации для <b>gdb</b>.
<p>Ключ <b>-gdwarf</b> добавляет инфомацию в формате <b>DWARF</b> приняотм в системе <b>System V Release 4</b>. Соответственно ключ <b>-gdwarf+</b> прибавляет возможностей отладчику <b>gdb</b>.
<p>Добавление к этим ключам в конце цифры позволяет увеличить или уменьшить уровень отладки, т.е. управлять размером требуемой отладочной информации. Например ключ:
<pre>
gcc -g3 ...
</pre>
<p>Увеличит уровень отладки до <b>3</b>, по умолчанию он равен <b>2</b>. При первом уровне отладки компилятор включает в файл минимальное количество отладочной информации достаточное для отладки частей программы, которые вы не планировли отлаживать. В эту информацию входит описание функций и внешних переменных, но не включается информация об локальных переменных и номерах строк исходного текста. Второй уровень - это уровень по умолчанию, включает в файл большинство нужной отладочной информации. Третий уровень позволяет добавить экстра-информацию, такую как определения присутствующих в программе макросов.
<p>Выше вы можете увидеть остальные ключи, которые можно использовать. Большинство этих ключей предназначено для вывода дампа программы во время компиляции и служит не для отладки программы, а для отладки самого компилятора :)) Поэтому о них можно забыть и не вспоминать.
<p>Отладочная информация это конечно хорошо, но она может значительно увеличить объем вашего файла (в три-четыре раза). Для создания программ "релизов" существует отдельная программа, позволяющая удалить отладочную информацию из запускаемого файла. Называется эта программа <b>strip</b>. Для того, чтобы полностью очистить файл от отладочной информации, требуется вызвать ее с ключом <b>-s</b>:
<pre>
strip -s a.out
</pre>
<p>После обработки файла этой командой его размер уменьшился практически в три раза и стал <b>3156</b> байт. По сравнению с 11 Кб до этого это очень даже хорошо.</div><center><hr><a href="javascript:if(confirm('http://www.firststeps.ru/linux/prog/2.zip  \n\nThis file was not retrieved by Teleport Pro, because it did not meet the project\'s file type specifications.  \n\nDo you want to open it from the server?'))window.location='http://www.firststeps.ru/linux/prog/2.zip'" tppabs="http://www.firststeps.ru/linux/prog/2.zip">Загрузить проект</a> | <a href="r.php-1.htm" tppabs="http://www.firststeps.ru/linux/r.php?1">Предыдущий Шаг</a> | <a href="r.php-3.htm" tppabs="http://www.firststeps.ru/linux/r.php?3">Следующий Шаг</a> | <a href="general1.html" tppabs="http://www.firststeps.ru/linux/general1.html">Оглавление</a><br>Автор <a href="mailto:kuzinandrey@yandex.ru?SUBJECT=From_part_general#2'_on_[www.firststeps.ru]">Кузин Андрей</a>.<hr><iframe src="javascript:if(confirm('http://ad.adriver.ru/cgi-bin/erle.cgi?sid=9595&target=blank&bt=1&pz=0&rnd=21211  \n\nThis file was not retrieved by Teleport Pro, because it did not meet the project\'s file type specifications.  \n\nDo you want to open it from the server?'))window.location='http://ad.adriver.ru/cgi-bin/erle.cgi?sid=9595&target=blank&bt=1&pz=0&rnd=21211'" tppabs="http://ad.adriver.ru/cgi-bin/erle.cgi?sid=9595&target=blank&bt=1&pz=0&rnd=21211" frameborder=0 vspace=0 hspace=0 width=468 height=60 marginwidth=0 marginheight=0 scrolling=no><a href="javascript:if(confirm('http://ad.adriver.ru/cgi-bin/click.cgi?sid=9595&bt=1&pz=0&rnd=21211  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://ad.adriver.ru/cgi-bin/click.cgi?sid=9595&bt=1&pz=0&rnd=21211'" tppabs="http://ad.adriver.ru/cgi-bin/click.cgi?sid=9595&bt=1&pz=0&rnd=21211" target=_blank><img src="rle.cgi-sid=9595&bt=1&pz=0&rnd=21211" tppabs="http://ad.adriver.ru/cgi-bin/rle.cgi?sid=9595&bt=1&pz=0&rnd=21211" alt="-AdRiver-" border=0 width=468 height=60></a></iframe></center><br><br>